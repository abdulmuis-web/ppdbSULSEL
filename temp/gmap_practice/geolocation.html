
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="imagetoolbar" content="no" />
		<meta name="author" content="Krasimir Tsonev" />
		<meta name="copyright" content="Krasimir Tsonev" />
		<meta name="robots" content="follow,index" />
		
		<meta name="keywords" content="Google Maps - address to location" lang="en-us" />
		<meta name="description" content="" />
		<title>Google Maps - address to location</title>
		
		<style type="text/css">
			body, html {
				margin: 0;
				padding: 10px;
				font-family: Verdana;
				font-size: 12px;
				color: #000;
			}
			#map-holder {
				display: block;
				width: 500px;
				height: 450px;
				margin: 10px 0 0 0;
			}
			#text {
				width: 430px;
			}
			#debug {
				position: absolute;
				top: 20px;
				left: 540px;
				font-size: 11px;
			}
		</style>

		<script language="JavaScript" type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&language=en"></script>
		<script language="JavaScript" type="text/javascript">
		
			var map = null;
			
			window.onload = function() {
				
				// initialize the map
				var mapHolder = document.getElementById("map-holder");
				map = new google.maps.Map(
					mapHolder, 
					{
						zoom: 3,
						mapTypeId: google.maps.MapTypeId.ROADMAP
					}
				);
				
				// centering the map
				map.setCenter(new google.maps.LatLng(43.229195, 27.872314));
				
				// adding events
				document.getElementById("search").onclick = function() {
					var address = document.getElementById("text").value;
					log("Address: " + address, true);
					addressToLocation(address, changeMapLocation);
				}
			
			}
			
			// processing the results
			function changeMapLocation(locations) {
				if(locations && locations.length) {
					log("Num of results: " + locations.length);
					var numOfLocations = locations.length;
					for(var i=0; i<numOfLocations; i++) {	
						log("- " + locations[i].text + " / <strong>" + locations[i].location.toString() + "</strong>");
						var marker = new google.maps.Marker({
							map: map,
							position: locations[i].location
						});
					}
					map.panTo(locations[0].location);
					map.setZoom(8);
				} else {
					log("Num of results: 0");
				}
			}
			
			// converting the address's string to a google.maps.LatLng object
			function addressToLocation(address, callback) {
				var geocoder = new google.maps.Geocoder();
				geocoder.geocode(
					{
						address: address
					}, 
					function(results, status) {
						
						var resultLocations = [];
						
						if(status == google.maps.GeocoderStatus.OK) {
							if(results) {
								var numOfResults = results.length;
								for(var i=0; i<numOfResults; i++) {
									var result = results[i];
									resultLocations.push(
										{
											text:result.formatted_address,
											addressStr:result.formatted_address,
											location:result.geometry.location
										}
									);
								};
							}
						} else if(status == google.maps.GeocoderStatus.ZERO_RESULTS) {
							// address not found
						}
						
						if(resultLocations.length > 0) {
							callback(resultLocations);
						} else {
							callback(null);
						}
					}
				);
			}
			
			// debugging
			function log(str, clear) {
				var debugHolder = document.getElementById("debug");
				if(clear) {
					debugHolder.innerHTML = "";
				}
				debugHolder.innerHTML = debugHolder.innerHTML + "<br />" + str;
			}
		
		</script>
		
	</head>
	<body>
		<input type="text" id="text" />
		<input type="button" id="search" value="search" />
		<div id="map-holder"></div>
		<div id="debug"></div>
	</body>
</html>